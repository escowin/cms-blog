{{#if loggedIn}}
<script defer src="/javascript/comment.js"></script>
{{/if}}

<article class="post">
  <div class="details">
    <h3 class="title"><a href="/post/{{post.id}}">{{post.title}}</a></h3>
    <p class="content">{{post.content}}</p>
  </div>
  <div class="meta">
    by
    {{post.user.username}}
    on
    {{post.created_at}}
    |
    <a href="/post/{{post.id}}">{{post.comments.length}} comment(s)</a>
  </div>
</article>

{{!-- only renders for logged in users due to the conditions set in the res.render('single-post) within home-routes --}}
{{#if loggedIn}}
<form id="comment-form">
  <div>
    <textarea name="comment-body"></textarea>
  </div>

  <div>
    <button type="submit">add comment</button>
  </div>
</form>
{{/if}}

<div id="comments">
  {{#each post.comments}}
    <section class="comment">
      <div class="meta">
        {{user.username}}
        on
        {{created_at}}
      </div>
      <div class="text">
        {{comment_text}}
      </div>
    </section>
  {{/each}}
</div>